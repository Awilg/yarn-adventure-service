// Ktor plugin still needs to be grabbed from here for some reason
buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.61"
	}
}

plugins {
	id 'org.jetbrains.kotlin.jvm' version '1.3.61'
	id 'org.jetbrains.dokka' version '0.10.0'
	id 'com.github.johnrengelman.shadow' version '5.0.0'
	id 'maven-publish'
}

allprojects {
	repositories {
		jcenter()
		mavenLocal()
	}

	sourceCompatibility = 1.8

	apply from: "${rootDir}/dependencies.gradle"
}

subprojects {
	project.group = "com.yarn.adventure"

	apply plugin: 'kotlin'
	apply plugin: 'application'
	apply plugin: 'org.jetbrains.kotlin.jvm'
	apply plugin: 'org.jetbrains.dokka'
	apply plugin: 'maven-publish'

	dokka {
		outputFormat = 'html'
		outputDirectory = "$buildDir/dokka"

		subProjects = [":adventure-svc-core",
					   ":adventure-svc-client"]
	}
}

project(':adventure-svc-core') {
	group   'com.yarn'
	version '0.0.1'

	// shadowjar throws a warning if the plugin is applied before the classname is defined.
	mainClassName = 'com.yarn.services.ApplicationKt'
	apply plugin: 'com.github.johnrengelman.shadow'
}

project(':adventure-svc-client') {
	group   'com.yarn'
	version '0.0.1'

	mainClassName = 'com.yarn.adventure.ApplicationKt'
	apply plugin: 'com.github.johnrengelman.shadow'
}
